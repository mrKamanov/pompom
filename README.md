# PomPom: Расширение для обработки текста через AI API

**Актуальная версия: 1.15**

![Логотип PomPom](icons/icon128.png)

PomPom - это расширение для браузера Chrome, которое позволяет быстро обрабатывать выделенный текст на любой веб-странице с помощью искусственного интеллекта (AI) через внешний API (например, AIMLAPI.com или OpenRouter.ai). Результат обработки отображается в удобном всплывающем окне, откуда его можно скопировать или автоматически напечатать в активное поле ввода.

## Требования

* Google Chrome или Microsoft Edge (последние версии)
* Доступ к AI API (например, AIMLAPI.com или OpenRouter.ai)
* API ключ от выбранного сервиса

## Возможности

* **Обработка выделенного текста:** Отправка любого выделенного текста на странице в настроенный AI API
* **Три пользовательских промпта:** Для каждого промпта можно задать название и использовать его через контекстное меню или горячую клавишу
* **Горячие клавиши:** Для каждого промпта и автопечати можно назначить свою комбинацию клавиш через chrome://extensions/shortcuts
* **Безопасное хранение API ключа:** 
  * Маскировка API ключа по умолчанию (точки/звездочки)
  * Кнопка показа/скрытия для проверки правильности ключа
  * Защита от случайного просмотра конфиденциальных данных
* **Настраиваемый API ключ:** Укажите ваш AI API ключ в безопасном режиме
* **Всплывающее окно с результатом:** Удобное, перетаскиваемое окно для отображения ответа от AI
* **Подсветка синтаксиса:** Автоматическая подсветка блоков кода в ответе AI с использованием Highlight.js
* **Копирование результата:** Быстрое копирование всего ответа AI в буфер обмена
* **Автоматический набор текста (Typewriter Effect):** 
  * Реалистичная имитация человеческого ввода
  * Пауза при потере фокуса
  * Возобновление только по нажатию кнопки или горячей клавиши
  * Отмена автопечати при ручном вводе
  * Настраиваемая скорость печати (минимальная и максимальная задержка)
* **Настраиваемая прозрачность окна:** Сохранение выбранной пользователем прозрачности
* **Чат-функция:** Возможность задавать уточняющие вопросы к AI с сохранением контекста беседы
* **Выбор провайдера AI API:** Теперь можно выбрать между AIMLAPI и OpenRouter в настройках расширения
* **Поддержка OpenRouter:**
  * Отдельное поле для API ключа OpenRouter (с кнопкой-глазиком для показа/скрытия)
  * Отдельное поле для выбора модели OpenRouter (по умолчанию: `google/gemma-3-27b-it:free`)
  * Совместимость с бесплатными и платными моделями OpenRouter
* **Скриншоты выбранной области:** 
  * Создание скриншотов любой области на веб-странице
  * Интуитивный интерфейс выбора области с помощью мыши
  * Автоматическое сохранение скриншота в формате PNG
  * Доступ через контекстное меню на любой странице
* **OCR распознавание текста с изображений:**
  * Распознавание текста с выбранной области экрана
  * Использование OCR.Space API для высокоточного распознавания
  * Поддержка русского и английского языков
  * Автоматическая обработка распознанного текста через AI API
  * Интеграция с существующей системой чата
* **Улучшенная обработка скриншотов:**
  * Обрезка скриншота по выбранной области
  * Передача координат области между компонентами
  * Оптимизированная обработка изображений с использованием OffscreenCanvas
* **Улучшенная система автопечати:**
  * Исправлена работа горячих клавиш для автопечати
  * Учет настроек скорости печати при использовании горячих клавиш
  * Надежная остановка автопечати при закрытии окна
  * Сохранение последнего результата для повторной печати
* **Улучшенная обработка истории чата:**
  * Правильное сохранение контекста беседы
  * Очистка истории при начале нового диалога
  * Сохранение только одобренных пользователем ответов
  * Предотвращение накопления неверных ответов в истории
* **Исправления и оптимизации:**
  * Исправлена работа кнопки "Копировать" в popup окне
  * Улучшена обработка выделенного текста в контекстном меню
  * Оптимизирована работа с DOM элементами
  * Улучшена обработка ошибок и исключений

## Установка

1. **Скачайте репозиторий:**
   * Клонируйте репозиторий: `git clone https://github.com/mrKamanov/pompom`
   * Или скачайте ZIP-архив и распакуйте его

2. **Установка в браузер:**
   * Откройте `chrome://extensions` (Chrome) или `edge://extensions` (Edge)
   * Включите "Режим разработчика"
   * Нажмите "Загрузить распакованное расширение"
   * Выберите папку с расширением

## Использование

1. **Настройка:**
   * Откройте настройки расширения через иконку в панели инструментов
   * Введите API ключ (по умолчанию скрыт, используйте кнопку глаза для показа)
   * Настройте промпт
   * Выберите провайдера AI API (AIMLAPI или OpenRouter)
   * Настройте скорость автопечати (минимальная и максимальная задержка)
   * Сохраните настройки

2. **Работа с текстом:**
   * Выделите текст на веб-странице
   * Правый клик → "Обработать текст"
   * Используйте всплывающее окно для:
     * Просмотра результата
     * Копирования текста
     * Автоматического ввода
     * Настройки прозрачности
     * Задавания уточняющих вопросов

3. **Создание скриншотов:**
   * Правый клик на любой веб-странице
   * Выберите "Скриншот выбранной области"
   * Нажмите и перетащите мышь для выбора области
   * Нажмите "Сделать скриншот" для сохранения
   * Или "Отмена" для отмены операции

4. **OCR распознавание текста:**
   * Правый клик на любой веб-странице
   * Выберите "Скриншот выбранной области"
   * Выберите область с текстом
   * Нажмите "Распознать и обработать"
   * Распознанный текст автоматически отправится в AI API
   * Результат обработки появится в popup окне

5. **Использование горячих клавиш:**
   * Настройте горячие клавиши в chrome://extensions/shortcuts
   * Используйте горячие клавиши для быстрого доступа к функциям


## Безопасность

* **API ключ маскируется** по умолчанию для защиты от случайного просмотра
* **Кнопка показа/скрытия** позволяет проверить правильность ключа при необходимости
* **Данные сохраняются** в защищенном хранилище браузера (chrome.storage.sync)
* **Нет передачи данных** на сторонние серверы (кроме настроенного AI API и OCR.Space)

## Поддержка автора ❤️

Если расширение PomPom помогло вам в работе, вы можете поддержать автора:

### 💰 Криптовалюты

**Toncoin (TON):**
```
UQB2pUhI3rUKiy-hR3mHMAcXvQ4_QNVGDEuFZcRU9qa7MMeA
```

**Bitcoin (BTC):**
```
19i9JauVSyDzv9KNDKV1Da9v36GwiZ6at3
```

### 🌟 Другие способы поддержки

* **Звездочка на GitHub** - поставьте ⭐ в репозитории
* **Поделитесь с друзьями** - расскажите о расширении
* **Сообщите об ошибках** - создайте issue на GitHub
* **Предложите улучшения** - поделитесь идеями для развития

## Структура проекта

```
pompom/
├── background.js      # Service Worker, логика API, горячие клавиши, меню
├── content.js         # UI и взаимодействие со страницей
├── inject.js          # Скрипт для имитации ввода (автопечать)
├── easyOCR.js         # Модуль OCR распознавания текста
├── styles.css         # Стили UI и настроек
├── options/           # Файлы для страницы настроек
│   ├── options.html
│   ├── options.js
│   ├── options.css
│   └── donations.js
├── manifest.json      # Конфигурация расширения
├── API/               # Модули для работы с разными AI API (AIMLAPI и др.)
│   ├── aimlapi.js
│   └── openrouterapi.js
├── icons/             # Иконки расширения
│   ├── icon48.png
│   └── icon128.png
└── lib/               # Сторонние библиотеки (Highlight.js и стили)
    ├── highlight.min.js
    ├── languages/
    └── styles/
```

## Разработка

1. Внесите изменения в код
2. Обновите расширение на странице `chrome://extensions`
3. Протестируйте изменения

## Лицензия

[MIT License](LICENSE)

## Автор

**Сергей Каманов**

- GitHub: [@mrKamanov](https://github.com/mrKamanov)
- Проект: [PomPom Extension](https://github.com/mrKamanov/pompom)

---
**Сделано с ❤️ для удобства работы с AI.**

## Горячие клавиши

Вы можете назначить любые удобные горячие клавиши для каждого промпта и автопечати:

1. Откройте chrome://extensions/shortcuts (или "chrome://расширения/ярлыки").
2. Найдите расширение PomPom.
3. Назначьте сочетания клавиш для:
   - Обработки выделенного текста с промптом 1
   - Обработки выделенного текста с промптом 2
   - Обработки выделенного текста с промптом 3
   - Запуска автопечати (имитация печати ответа на странице)

> Это позволяет использовать PomPom максимально быстро, не открывая меню!

## История версий

### v1.15 (Текущая)
- ✅ Добавлено OCR распознавание текста с изображений
- ✅ Улучшена обработка скриншотов с обрезкой по области
- ✅ Исправлена работа горячих клавиш для автопечати
- ✅ Улучшена система истории чата
- ✅ Исправлена кнопка "Копировать" в popup окне
- ✅ Добавлена настройка скорости автопечати
- ✅ Оптимизирована работа с DOM элементами


## TODO

- Поддержка дополнительных поставщиков AI API
- Расширенные настройки OCR
- Экспорт/импорт настроек

